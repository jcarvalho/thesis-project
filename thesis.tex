\documentclass{llncs}
\usepackage[utf8]{inputenc}
\usepackage{tikz}
\usepackage[simplified]{pgf-umlcd}
\usepackage{cite}
\usepackage{listings}
%
\begin{document}

\title{LongXact: Making Long-Lived Transactions Easier to Develop}

%% Title
\author{João Pedro Carvalho}
\institute{Técnico de Lisboa/Universidade Técnica de Lisboa
\email{joao.pedro.carvalho@ist.utl.pt}}
\maketitle

%% Abstract

\begin{abstract}
Over the past years, Software Transactional Memories have become more
and more popular, growing to be something more than simply a research topic. On top of
that, the concept has been extended to encompass persistence, so
the concept of Persistent Software Transactional Memories was born. In
this thesis, I propose an extension to PSTM's in order to support the
concept of Long-Lived Transactions. Some research on the topic has
been conducted in the field of Database Transactions and Workflow
systems. My thesis is that supporting Long-Lived Transactions should
be done at the infrastructural level on Persistent STM's, so this
paper will describe how those systems can be extended to support
Long-Lived Transactions.
\end{abstract}

%% Intro

\section{Introduction}

For many years, enterprise applications were developed using
two-tiered architectures. In such architectures, there was typically a
mainframe with great computational power.

Long-Lived Transactions were first described in
1981 as ``[..] transactions with lifetimes of a few days or
weeks''\cite{gray1981transaction}. At the time, the author said that the
solution for this 

In this project, I aim at adding support for Long-Lived Transactions
in applications with Rich Domain Models.
Rich Domain Models are ``An object model of the domain that
incorporates both behavior and data.``, as described by \cite{fowler2003patterns}.

\section{Long-Lived Transactions}

\subsection{What are Long-Lived Transactions?}
\label{sec:what}

As previously described, Long-Lived Transactions are transactions with
a lifetime larger than a typical database transaction. In order to
better understand this concept, consider the following example, found
in the applications of many education institutions.

\begin{figure}
\centering
\begin{tikzpicture}

\begin{class}[text width=4.5cm]{Course}{0.5,0}
\attribute{name : String}
\attribute{objectives : String}
\attribute{credits : int}
\attribute{bibliography : Publication[]}
\end{class}

\begin{class}[text width=3cm]{Department}{7.5,-0.85}
\end{class}

\association{Department}{}{1}{Course}{}{*}

\end{tikzpicture}

\caption{Sample Domain Model in UML} 
\label{fig:courseDomain}

\end{figure}

In the domain model presented in Figure~\ref{fig:courseDomain}, we
have a simplification of the Course concept

Mention here that multiple users will be able to *see* the
transactional context?

\subsection{Why are they difficult to implement?}

Web frameworks provide a wide range of features to the
programmer. 

Transactional support, however, is still somewhat raw in most
Frameworks. Typically, transactions are handled by some database
beneath them, so the framework is just a thin layer, delegating all
the work.

Revisiting the example presented in \ref{sec:what}, there are several
ways to implement the second case (in which user interaction is made
in several steps).

\begin{enumerate}
\item Keeping a database transaction open during all the steps of the
  operation

\item Create a parallel representation of the objects that are being
  manipulated, store them outside the domain, and applying the changes
  only in the last interaction

\item Change the domain model, to represent the consistency state of
  the objects being manipulated. This affects the code that operates
  on that portion of the domain, since it must filter objects that are
  still in an inconsistent state
\end{enumerate}

All the approaches presented above are deemed unacceptable, since they
require explicit intervention by the programmer. 

This section should present only general difficulties, each individual
sub-section of (3)

\subsection{Applications of LLTs}

Long-Lived Transactions are useful in many contexts, 

\subsubsection{Database Management Systems}

*Explain how long-lived transactions are typically implemented in DBMS's*

\subsubsection{Workflow Systems}

Workflow Managements Systems have seen many developments over the last
years.

Workflow systems 

*Explain common use cases of LLT's on Workflow systems, and why are
they so important*


\section{Related Work}

In this section I describe the various topics in which an attempt to
solve the problem of Long Lived Transactions has been made, namely
Database Management Systems, Workflow Systems and Object Oriented
Transactional Systems.

Also, due to its relevance regarding the
solution described in section 4, I briefly present Software
Transactional Memories, and how they cope with short lived transactions.

\subsection{Database world}

*Mention classic books*

*Mention Martin Fowler's patterns \cite{fowler2003patterns}*

*Relaxation of transactional properties*

*Several Papers: \cite{hagmann1991implementing} \cite{garcia1987sagas}
\cite{salem1989altruistic}

*Talk about isolation levels*

*Mention that the best implementations of LLT's at the database level
provide only Serializability at best*

\subsection{Workflow Management Systems}

*Sagas* \cite{garcia1987sagas}

\cite{798492}

*Compensations*

*Exception Handling systems*

*Explain why those solutions are not good, since they *may* break ACI
of the ACID model*

\subsection{Object-Relational Mappings}

*Talk about how ORM's handle transactions, i.e. Hibernate*

\subsection{Object-Oriented}

*Talk about ORM's in Object Oriented systems, such as Hibernate*

*Talk about the Fenix Framework, how it implements a Persistent STM,
mention that the Framework brings Strict Serializability to a
'transparent' programming model* \cite{fernandes2011strict} 
\cite{guerraoui2008correctness} \cite{cachopo2006versioned}

*Talk about how this project aims at extending the FF model to support LLT's*

\subsection{STM's}
\label{sec:stm}


\section{Solution Architecture}

In this section I will describe the architecture of my proposed
solution, as well as a small introduction to the Fénix Framework
\cite{fernandes2011strict}, in which it will be implemented.

\subsection{Fenix Framework}

STMs, PSTMs, DML

\ref{sec:stm}

Describe that the solution will be build on top of the Fenix Framework
core, plus JVSTM, making it agnostic to the specific persistence
backend in use. 

\subsection{Transactional Contexts}

The basic building block 

\subsection{Programming Model}

\lstset{language=Java,frame=single,caption={Sample
  implementation of a method that runs inside a Long Lived
  Transaction}}
\begin{lstlisting}

public CourseCreation(Department department) {
  this.setDepartment(department);
  this.setNewCourse(new Course());
  department.addCourse(this.getNewCourse());
}

@Step
public void createNewCourse(String courseName) {
  this.getNewCourse().setName(courseName);
}

@Step(last = true)
public void setBibliography(Publication[] bibliography) {
  this.getNewCourse().setBibliography(bibliography);
}
\end{lstlisting}

\section{Evaluation}

The final evaluation of this project will be measured in terms of:
- Programmer effort needed to use LLT's
- Performance, throughput, Commit/Abort ratios, interleaving LLTs with
'regular' transactions

\section{Conclusion}

\bibliography{thesis.bib}
\bibliographystyle{plain}
\end{document}
